<div class="backdrop" ui-sref="^"></div>

<div class="inner-container" go-back>
    <div class="modal-wrapper">
        <div class="custom-modal">
        <div class="modal-dialog">
          <div class="modal-content animated rollIn">
            <div class="modal-header" style="text-align: center">
              <div
                class="btn btn-default back-button"
                ng-if="withButton"
                ng-click="onBackClick()"
              >
                <i class="fas fa-arrow-left"></i>
              </div>
              {{::unit.name}}
            </div>

<div class="modal-body" id="modal-body-top">
            
            <div
            ng-click="openBigThumbTab(unit.id)"
            class="slot responsive"
            decorate-slot
            big="true"
            uid="unit.id"
          ></div>
            <div style="margin: 15px 0 5px 0; text-align: center;">
              <label>
                <input
                  type="checkbox"
                  ng-model="characterLog[id]"
                  ng-change="checkLog()"
                />
                In Character Log
              </label>
            </div>

          <details-card title="Details" section-id="details">
            <div class="panel panel-default stats-pane panel-x-scroll">
              <table class="table">
                <thead>
                  <tr>
                    <th ng-if="dualunit">Unit</th>
                    <th>Type</th>
                    <th>Class</th>
                    <th>Combo</th>
                    <th>Sockets</th>
                    <th>Cost</th>
                    <th>Level</th>
                    <th>Max EXP</th>
                    <th>Stars</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Dual Unit: Combined Row -->
                  <tr ng-if="dualunit" class="dual-unit-group-header">
                    <td><strong>{{ details.VSSpecial ? 'Shared Stats' : 'Dual Form' }}</strong></td>
                    <td ng-if="!details.VSSpecial">
                      <span ng-bind-html="char1.type | decorate"></span>
                      <span ng-if="char1.type !== char2.type"> / <span ng-bind-html="char2.type | decorate"></span>
                      </span>
                  </td>
                  <td ng-if="details.VSSpecial" colspan="3"></td>
                  <td ng-if="!details.VSSpecial">{{::unit.class[0]}}/{{::unit.class[1]}}</td>
                    <td ng-if="!details.VSSpecial">{{::unit.combo}}</td>
                    <td>{{::unit.sockets}}<span ng-if="unit.sockets!==unit.limitexSocket">→{{::unit.limitexSocket}}</span></td>
                    <td>{{::unit.cost}}</td>
                    <td>{{::unit.maxLevel}}</td>
                    <td>{{::unit.maxEXP}}</td>
                    <td>{{::unit.stars}}</td>
                  </tr>
                  <!-- Dual Unit Variants -->
                  <tr class="dual-unit-character-header" ng-if="dualunit" ng-repeat-start="char in [char1, char2] track by $index">
                  <td><strong>{{::char.name}}</strong></td>
                  <td><span ng-bind-html="char.type | decorate"></span></td>
                  <td>{{::char.class[0]}}/{{::char.class[1]}}</td>
                  <td>{{::char.combo}}</td>   
                  <td colspan="5" class="text-muted"></td>
                  </tr>
                  <tr ng-repeat-end class="dual-unit-character-tags" ng-if="dualunit">
                  <td colspan="9" class="tags-row">Tags:
                      <span class="badge" style="margin-right: 2px" ng-repeat="tag in getTagsForUnit(char)" ng-class="getCategoryClass(tag)">{{::tag}}</span>
                  </td>
                  </tr>                

                  <!-- Single Unit: Content Row -->
                  <tr ng-if="!dualunit">
                    <td><span ng-bind-html="unit.type | decorate"></span></td>
                    <td>{{::!hybrid ? unit.class : unit.class[0] + '/' + unit.class[1]}}</td>
                    <td>{{::unit.combo}}</td>
                    <td>{{::unit.sockets}}<span ng-if="unit.sockets!=unit.limitexSocket">→{{::unit.limitexSocket}}</span></td>
                    <td>{{::unit.cost}}</td>
                    <td>{{::unit.maxLevel}}</td>
                    <td>{{::unit.maxEXP}}</td>
                    <td>{{::unit.stars}}</td>
                  </tr>

                  <!-- Single Unit: Tags Row -->
                  <tr ng-if="!dualunit">
                    <td colspan="8" class="tags-row">Tags:
                      <span class="badge" style="margin-right: 2px" ng-repeat="tag in getTagsForUnit(unit)" ng-class="getCategoryClass(tag)">{{::tag}}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </details-card>

                      <details-card title="Stats" section-id="stats" ng-hide="hidden.stats">

                            <div class="panel panel-default panel-x-scroll">
                                <table class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Level<form>
                                                    <label><input type="radio" name="statPreference"
                                                            ng-model="statPreference" value=0 checked>None</label><br>
                                                    <label><input type="radio" id="lb" name="statPreference"
                                                            ng-model="statPreference" value=1>Limit Break</label><br>
                                                    <label><input type="radio" id="lbex" name="statPreference"
                                                            ng-model="statPreference" value=2>Limit Break
                                                        Expansion</label>
                                                </form>
                                            </th>
                                            <th style="width:15%">HP</th>
                                            <th style="width:15%">ATK</th>
                                            <th style="width:15%">RCV</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>1</td>
                                            <td>{{::unit.minHP | number}}</td>
                                            <td>{{::unit.minATK | number}}</td>
                                            <td>{{::unit.minRCV | number}}</td>
                                        </tr>
                                        <tr>
                                            <td>{{::unit.maxLevel}}</td>
                                            <td>{{unit.maxHP+[0, unit.limitHP-unit.maxHP,
                                                unit.limitexHP-unit.maxHP][statPreference] | number}}<span
                                                    ng-if="statPreference != 0"> (+{{[0, unit.limitHP-unit.maxHP,
                                                    unit.limitexHP-unit.maxHP][statPreference]}})</span></td>
                                            <td>{{unit.maxATK+[0, unit.limitATK-unit.maxATK,
                                                unit.limitexATK-unit.maxATK][statPreference] | number}}<span
                                                    ng-if="statPreference != 0"> (+{{[0, unit.limitATK-unit.maxATK,
                                                    unit.limitexATK-unit.maxATK][statPreference]}})</span></td>
                                            <td>{{unit.maxRCV+[0, unit.limitRCV-unit.maxRCV,
                                                unit.limitexRCV-unit.maxRCV][statPreference] | number}}<span
                                                    ng-if="statPreference != 0"> (+{{[0, unit.limitRCV-unit.maxRCV,
                                                    unit.limitexRCV-unit.maxRCV][statPreference]}})</span></td>
                                        </tr>
                                        <tr ng-if="unit.maxLevel == 99">
                                            <td>150 (approx.)</td>
                                            <td><span>{{unit.llbmaxHP+[0, unit.limitHP-unit.maxHP,
                                                    unit.limitexHP-unit.maxHP][statPreference] | number}}<span
                                                        ng-if="statPreference != 0"> (+{{[0, unit.limitHP-unit.maxHP,
                                                        unit.limitexHP-unit.maxHP][statPreference]}})</span></span></td>
                                            <td>
                                                <span>{{unit.llbmaxATK+[0, unit.limitATK-unit.maxATK, unit.limitexATK-unit.maxATK][statPreference] | number}}<span
                                                        ng-if="statPreference != 0"> (+{{[0, unit.limitATK-unit.maxATK, unit.limitexATK-unit.maxATK][statPreference]}})</span></span>
                                            </td>
                                            <td><span>{{unit.llbmaxRCV+[0, unit.limitRCV-unit.maxRCV, unit.limitexRCV-unit.maxRCV][statPreference] | number}}<span
                                                        ng-if="statPreference != 0"> (+{{[0, unit.limitRCV-unit.maxRCV, unit.limitexRCV-unit.maxRCV][statPreference]}})</span></span>
                                            </td>
                                        </tr>
                                        <tr ng-if="!((unit.limitHP-unit.maxHP == 0) && (unit.limitATK-unit.maxATK == 0) && (unit.limitRCV-unit.maxRCV == 0))">
                                            <td>Limit Break</td>
                                            <td>{{::unit.limitHP | number}} (+{{::unit.limitHP-unit.maxHP | number}})</td>
                                            <td>{{::unit.limitATK | number}} (+{{::unit.limitATK-unit.maxATK | number}})</td>
                                            <td>{{::unit.limitRCV | number}} (+{{::unit.limitRCV-unit.maxRCV | number}})</td>
                                        </tr>
                                        <tr ng-if="!((unit.limitexHP == unit.limitHP) && (unit.limitexATK == unit.limitATK) && (unit.limitexRCV == unit.limitRCV))">
                                            <td>Limit Break Expansion</td>
                                            <td>{{::unit.limitexHP | number}} (+{{::unit.limitexHP-unit.maxHP | number}})</td>
                                            <td>{{::unit.limitexATK | number}} (+{{::unit.limitexATK-unit.maxATK | number}})</td>
                                            <td>{{::unit.limitexRCV | number}} (+{{::unit.limitexRCV-unit.maxRCV | number}})</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </details-card>


                    <!-- Captain -->
<details-card title="Captain" section-id="captain" ng-hide="hidden.abilities" ng-if="details.captain">
                      <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.lLimit[2].captain">
                                    <td style="width: 50%"><strong>Base</strong></td>
                                    <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="{{details.captain.llbbase || details.captain.llbcharacter1 ? 1 : 2}}">
                                        <!-- same captain ability -->
                                        <div ng-if="!isCaptainHybrid" ng-bind-html="details.captain | decorate"></div>
                                        <!-- different captain abilities -->
                                        <div ng-if="isCaptainHybrid">
                                            <span class="badge badge-base" ng-show="details.captain.base">Base</span>
                                            <div ng-show="details.captain.base"
                                                ng-bind-html="details.captain.base | decorate"></div>
                                            <span class="badge badge-level1" ng-show="details.captain.level1">LB Level 1</span>
                                            <div ng-show="details.captain.level1"
                                                ng-bind-html="details.captain.level1 | decorate"></div>
                                            <span class="badge badge-level2" ng-show="details.captain.level2">LB Level 2</span>
                                            <div ng-show="details.captain.level2"
                                                ng-bind-html="details.captain.level2 | decorate"></div>
                                            <span class="badge badge-level3" ng-show="details.captain.level3">LB Level 3</span>
                                            <div ng-show="details.captain.level3"
                                                ng-bind-html="details.captain.level3 | decorate"></div>
                                            <span class="badge badge-level4" ng-show="details.captain.level4">LB Level 4</span>
                                            <div ng-show="details.captain.level4"
                                                ng-bind-html="details.captain.level4 | decorate"></div>
                                            <span class="badge badge-level5" ng-show="details.captain.level5">LB Level 5</span>
                                            <div ng-show="details.captain.level5"
                                                ng-bind-html="details.captain.level5 | decorate"></div>
                                            <span class="badge badge-level6" ng-show="details.captain.level6">LB Level 6</span>
                                            <div ng-show="details.captain.level6"
                                                ng-bind-html="details.captain.level6 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.captain.character1">{{::char1.name}}</span>
                                            <div ng-show="details.captain.character1"
                                                ng-bind-html="details.captain.character1 | decorate"></div><br>
                                            <span class="badge badge-character"
                                                ng-show="details.captain.character2">{{::char2.name}}</span>
                                            <div ng-show="details.captain.character2"
                                                ng-bind-html="details.captain.character2 | decorate"></div><br>
                                            <span class="badge badge-combined" ng-show="details.captain.combined">Dual Character<br></span>
                                            <div ng-show="details.captain.combined"
                                                ng-bind-html="details.captain.combined | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.captainNotes"
                                            ng-bind-html="details.captainNotes | notes | decorate"></span>
                                    </td>
                                    <td
                                        ng-if="isCaptainHybrid && (details.captain.llbbase || details.captain.llbcharacter1)">
                                        <div ng-if="isCaptainHybrid">
                                            <span class="badge badge-base" ng-show="details.captain.llbbase">LLB Base
                                               </span>
                                            <div ng-show="details.captain.llbbase"
                                                ng-bind-html="details.captain.llbbase | decorate"></div>
                                            <span class="badge badge-level1" ng-show="details.captain.llblevel1">LLB LB
                                                Level 1</span>
                                            <div ng-show="details.captain.llblevel1"
                                                ng-bind-html="details.captain.llblevel1 | decorate"></div>
                                            <span class="badge badge-level2" ng-show="details.captain.llblevel2">LLB LB
                                                Level 2</span>
                                            <div ng-show="details.captain.llblevel2"
                                                ng-bind-html="details.captain.llblevel2 | decorate"></div>
                                            <span class="badge badge-level6" ng-show="details.captain.llblevel6">LLB LB
                                                Level 6</span>
                                            <div ng-show="details.captain.llblevel6"
                                                ng-bind-html="details.captain.llblevel6 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.captain.llbcharacter1">{{::char1.name}}</span>
                                            <div ng-show="details.captain.llbcharacter1"
                                                ng-bind-html="details.captain.llbcharacter1 | decorate"></div><br>
                                            <span class="badge badge-character"
                                                ng-show="details.captain.llbcharacter2">{{::char2.name}}</span>
                                            <div ng-show="details.captain.llbcharacter2"
                                                ng-bind-html="details.captain.llbcharacter2 | decorate"></div><br>
                                            <span class="badge badge-combined" ng-show="details.captain.llbcombined">Dual Character</span>
                                            <div ng-show="details.captain.llbcombined"
                                                ng-bind-html="details.captain.llbcombined | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.captainNotes"
                                            ng-bind-html="details.captainNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Special -->
<details-card title="Special" section-id="special" ng-hide="hidden.abilities" ng-if="details.special">
                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.lLimit[4].special">
                                    <td style="width: 50%"><strong>Base</strong></td>
                                    <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="{{details.special.llbbase || details.special.llbcharacter1 ? 1 : 2}}">
                                        <strong class="specialName"
                                            ng-if="details.specialName">{{::details.specialName}}</strong>
                                        <!-- same special, no stages -->
                                        <div ng-if="!isSpecialHybrid && !isSpecialStaged"
                                            ng-bind-html="details.special | decorate"></div>
                                        <!-- same special, with stages -->
                                        <div ng-if="!isSpecialHybrid && isSpecialStaged">
                                            <div ng-repeat="stage in details.special track by $index">
                                                <strong>Stage {{::$index + 1}}</strong>
                                                ({{::stage.cooldown.length ? stage.cooldown[0] :
                                                stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                stage.cooldown[1] : ''}} turns) <span
                                                    ng-if="unit.limitCD != 0"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitCD) : ''}} turns)</span><span
                                                    ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitexCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitexCD) : ''}} turns)</span>:
                                                <span ng-bind-html="stage.description | decorate"></span>
                                            </div>
                                        </div>
                                        <!-- different specials -->
                                        <div ng-if="isSpecialHybrid && !isSpecialStaged">
                                            <span class="badge badge-slevel" ng-show="details.special.base">Base</span>
                                            <div ng-show="details.special.base"
                                                ng-bind-html="details.special.base | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.special.character1">{{::char1.name}}</span>
                                            <div ng-show="details.special.character1"
                                                ng-bind-html="details.special.character1 | decorate"></div><br>
                                            <span class="badge badge-character"
                                                ng-show="details.special.character2">{{::char2.name}}</span>
                                            <div ng-show="details.special.character2"
                                                ng-bind-html="details.special.character2 | decorate"></div><br>
                                            <span class="badge badge-combined"
                                                ng-show="details.special.combined">Combined</span>
                                            <div ng-show="details.special.combined"
                                                ng-bind-html="details.special.combined | decorate"></div>
                                        </div>
                                        <div ng-if="isSpecialHybrid && isSpecialStaged">
                                            <span class="badge badge-base" ng-show="details.special.base">Base</span><br>
                                            <div ng-repeat="stage in details.special.base track by $index">
                                                <strong>Stage {{::$index + 1}}</strong>
                                                ({{::stage.cooldown.length ? stage.cooldown[0] :
                                                stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                stage.cooldown[1] : ''}} turns) <span
                                                    ng-if="unit.limitCD != 0"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitCD) : ''}} turns)</span><span
                                                    ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitexCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitexCD) : ''}} turns)</span>:
                                                <span ng-bind-html="stage.description | decorate"></span>
                                            </div>
                                        </div>
                                        <span class="notes" ng-if="details.specialNotes"
                                            ng-bind-html="details.specialNotes | notes | decorate"></span>
                                    </td>
                                    <td ng-if="details.special.llbbase || details.special.llbcharacter1">
                                        <strong class="specialName"
                                            ng-if="details.specialName">{{::details.specialName}}</strong>
                                        <!-- different specials -->
                                        <div ng-if="isSpecialHybrid && !isSpecialStaged">
                                            <span class="badge badge-slevel" ng-show="details.special.llbbase">LLB Base</span>
                                            <div ng-show="details.special.llbbase"
                                                ng-bind-html="details.special.llbbase | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.special.llblevel1">LLB
                                                Level 1</span>
                                            <div ng-show="details.special.llblevel1"
                                                ng-bind-html="details.special.llblevel1 | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.special.llblevel2">LLB
                                                Level 2 Special</span>
                                            <div ng-show="details.special.llblevel2"
                                                ng-bind-html="details.special.llblevel2 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.special.llbcharacter1">{{::char1.name}} LLB</span>
                                            <div ng-show="details.special.llbcharacter1"
                                                ng-bind-html="details.special.llbcharacter1 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.special.llbcharacter2">{{::char2.name}} LLB</span>
                                            <div ng-show="details.special.llbcharacter2"
                                                ng-bind-html="details.special.llbcharacter2 | decorate"></div>
                                            <span class="badge badge-combined" ng-show="details.special.llbcombined">LLB Combined</span>
                                            <div ng-show="details.special.llbcombined"
                                                ng-bind-html="details.special.llbcombined | decorate"></div>
                                        </div>
                                        <div ng-if="isSpecialHybrid && isSpecialStaged">
                                            <span class="badge badge-level1" ng-show="details.special.llbbase">LLB Base</span><br>
                                            <div ng-repeat="stage in details.special.llbbase track by $index">
                                                <strong>Stage {{::$index + 1}}</strong>
                                                ({{::stage.cooldown.length ? stage.cooldown[0] :
                                                stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                stage.cooldown[1] : ''}} turns) <span
                                                    ng-if="unit.limitCD != 0"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitCD) : ''}} turns)</span><span
                                                    ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitexCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' +
                                                    (stage.cooldown[1] - unit.limitexCD) : ''}} turns)</span>:
                                                <span ng-bind-html="stage.description | decorate"></span>
                                            </div>
                                        </div>
                                        <span class="notes" ng-if="details.specialNotes"
                                            ng-bind-html="details.specialNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                                <tr ng-if="cooldown && !isSpecialStaged && !isCooldownHybrid">
                                    <td width="5%">Cooldown <span ng-if="unit.limitCD != 0"><br>CD + LB</span><span
                                            ng-if="unit.limitexCD != 0 && unit.limitCD != unit.limitexCD"><br>CD +
                                            LB+</span></td>
                                    <td colspan="{{details.special.llbbase ? 2 : 1}}">
                                        {{::cooldown.length ? cooldown[0] : cooldown}} turns
                                        {{::cooldown.length ? ' \u2192 ' + cooldown[1] + ' turns' : ''}}<span
                                            ng-if="unit.limitCD != 0"><br>
                                            {{::cooldown.length ? (cooldown[0] - unit.limitCD) : (cooldown -
                                            unit.limitCD)}} turns
                                            {{::cooldown.length ? ' \u2192 ' + (cooldown[1] - unit.limitCD) + ' turns' :
                                            ''}}</span><span
                                            ng-if="unit.limitexCD != 0 && unit.limitCD != unit.limitexCD"><br>
                                            {{::cooldown.length ? (cooldown[0] - unit.limitexCD) : (cooldown -
                                            unit.limitexCD)}} turns
                                            {{::cooldown.length ? ' \u2192 ' + (cooldown[1] - unit.limitexCD) + ' turns'
                                            : ''}}</span>
                                    </td>
                                </tr>
                                <tr ng-if="details.specialCooldown">
                                    <td>Cooldown<span ng-if="unit.limitCD != 0"><br>CD + LB</span><span
                                            ng-if="unit.limitexCD != 0 && unit.limitCD != unit.limitexCD"><br>CD +
                                            LB+</span></td>
                                    <td colspan="{{details.special.llbbase ? 2 : 1}}">
                                        {{::details.specialCooldown.length ? details.specialCooldown[0] :
                                        details.specialCooldown}} turns
                                        {{::details.specialCooldown.length ? ' \u2192 ' + details.specialCooldown[1] + '
                                        turns' : ''}}<span ng-if="unit.limitCD != 0"><br>
                                            {{::details.specialCooldown.length ? (details.specialCooldown[0] -
                                            unit.limitCD) : (details.specialCooldown - unit.limitCD)}} turns
                                            {{::details.specialCooldown.length ? ' \u2192 ' +
                                            (details.specialCooldown[1] - unit.limitCD) + ' turns' : ''}}</span><span
                                            ng-if="unit.limitexCD != 0 && unit.limitCD != unit.limitexCD"><br>
                                            {{::details.specialCooldown.length ? (details.specialCooldown[0] -
                                            unit.limitexCD) : (details.specialCooldown - unit.limitexCD)}} turns
                                            {{::details.specialCooldown.length ? ' \u2192 ' +
                                            (details.specialCooldown[1] - unit.limitexCD) + ' turns' : ''}}</span>
                                    </td>
                                </tr>
                                <tr ng-if="cooldown && !isSpecialStaged && isCooldownHybrid">
                                    <td>Cooldown Japan<span ng-if="unit.limitCD != 0"><br>Cooldown w/ LB</span><br><br>
                                        Cooldown Global<span ng-if="unit.limitCD != 0"><br>Cooldown w/ LB</span></td>
                                    <td>
                                        {{::cooldown[0].length ? cooldown[0][0] : cooldown[0]}} turns
                                        {{::cooldown[0].length ? ' \u2192 ' + cooldown[0][1] + ' turns' : ''}}<span
                                            ng-if="unit.limitCD != 0"><br>
                                            {{::cooldown[0].length ? (cooldown[0][0] - unit.limitCD) : (cooldown[0] -
                                            unit.limitCD)}} turns
                                            {{::cooldown[0].length ? ' \u2192 ' + (cooldown[0][1] - unit.limitCD) + '
                                            turns' : ''}}</span><br><br>
                                        {{::cooldown[1].length ? cooldown[1][0] : cooldown[1]}} turns
                                        {{::cooldown[1].length ? ' \u2192 ' + cooldown[1][1] + ' turns' : ''}}<span
                                            ng-if="unit.limitCD != 0"><br>
                                            {{::cooldown[1].length ? (cooldown[1][0] - unit.limitCD) : (cooldown[1] -
                                            unit.limitCD)}} turns
                                            {{::cooldown[1].length ? ' \u2192 ' + (cooldown[1][1] - unit.limitCD) + '
                                            turns' : ''}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Super Special -->
<details-card title="Super Special" section-id="superSpecial" ng-hide="hidden.abilities" ng-if="details.superSpecial">
                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.superSpecial">
                                    <td>
                                        <strong class="specialName"
                                            ng-if="details.superSpecialName">{{::details.superSpecialName}}</strong>
                                        <!-- same special, no stages -->
                                        <div ng-if="!isSuperSpecialHybrid && !isSuperSpecialStaged"
                                            ng-bind-html="details.superSpecial | decorate"></div>
                                        <!-- same special, with stages -->
                                        <div ng-if="!isSuperSpecialHybrid && isSuperSpecialStaged">
                                            <div ng-repeat="stage in details.superSpecial track by $index">
                                                <strong>Stage {{::$index + 1}}</strong>
                                                ({{::stage.cooldown.length ? stage.cooldown[0] :
                                                stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + stage.cooldown[1] : ''}}
                                                turns) <span ng-if="unit.limitCD != 0"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + (stage.cooldown[1] -
                                                    unit.limitCD) : ''}} turns):</span><span
                                                    ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                                    ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitexCD :
                                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + (stage.cooldown[1] -
                                                    unit.limitexCD) : ''}} turns):</span>
                                                <span ng-bind-html="stage.description | decorate"></span>
                                            </div>
                                        </div>
                                        <!-- different specials -->
                                        <div ng-if="isSuperSpecialHybrid">
                                            <span class="badge badge-character" ng-show="details.superSpecial.character1">{{::char1.name}}</span>
                                            <div ng-show="details.superSpecial.character1"
                                                ng-bind-html="details.superSpecial.character1 | decorate"></div>
                                            <span class="badge badge-character" ng-show="details.superSpecial.character2">{{::char2.name}}</span>
                                            <div ng-show="details.superSpecial.character2"
                                                ng-bind-html="details.superSpecial.character2 | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.superSpecialNotes"
                                            ng-bind-html="details.superSpecialNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                                <tr ng-if="details.superSpecialCriteria">
                                    <td>
                                        <div>
                                            <strong>Criteria</strong><br>
                                            <span ng-bind-html="details.superSpecialCriteria | decorate"></span>
                                        </div>
                                    </td>
                                </tr>
                                <tr ng-if="details.superSpecialCriteria">
                                    <td>
                                        <add-super-special-query criteria="details.superSpecialCriteria"
                                            excluded-families="families"></add-super-special-query>
                                        <div class="notes" ng-if="details.superSpecialCriteriaNotes"
                                            ng-bind-html="details.superSpecialCriteriaNotes | notes | decorate"></div>
                                    </td>
                                </tr>
                    </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- VS Special -->
<details-card title="VS Special" section-id="vsSpecial" ng-hide="hidden.abilities" ng-if="details.VSSpecial">
                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.VSSpecial">
                                    <td>
                        <!-- same special, no stages -->
                        <div ng-if="!isVSSpecialHybrid && !isVSSpecialStaged"
                        ng-bind-html="details.superSpecial | decorate"></div>
                        <!-- same special, with stages -->
                        <div ng-if="!isVSSpecialHybrid && isVSSpecialStaged">
                            <div ng-repeat="stage in details.VSSpecial track by $index">
                                <strong>Stage {{::$index + 1}}</strong>
                                ({{::stage.cooldown.length ? stage.cooldown[0] :
                                    stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + stage.cooldown[1] : ''}} turns)
                                    <span ng-if="unit.limitCD != 0"><strong>➤</strong>
                                        ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitCD :
                                            stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + (stage.cooldown[1] -
                                            unit.limitCD) : ''}} turns):</span><span
                                            ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                            ({{::stage.cooldown.length ? stage.cooldown[0] - unit.limitexCD :
                                                stage.cooldown}}{{::stage.cooldown.length ? ' \u2192 ' + (stage.cooldown[1] -
                                                unit.limitexCD) : ''}} turns):</span>
                                                <span ng-bind-html="stage.description | decorate"></span>
                                            </div>
                                        </div>
                                        <!-- different specials -->
                                        <div ng-if="isVSSpecialHybrid">
                                            <span class="badge badge-character" ng-show="details.VSSpecial.character1">{{::char1.name}}</span>
                                            <div ng-show="details.VSSpecial.character1"
                                            ng-bind-html="details.VSSpecial.character1 | decorate"></div>
                                            <span class="badge badge-character" ng-show="details.VSSpecial.character2">{{::char2.name}}</span>
                                            <div ng-show="details.VSSpecial.character2"
                                            ng-bind-html="details.VSSpecial.character2 | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.VSSpecialNotes"
                                        ng-bind-html="details.VSSpecialNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                                <tr ng-if="details.VSCondition">
                                    <td>
                                        <div><strong>Condition</strong><br>
                                            <span ng-bind-html="details.VSCondition | decorate"></span>
                                        </div>
                                    </td>
                                        <span class="notes" ng-if="details.VSConditionNotes"
                                            ng-bind-html="details.VSConditionNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Sailor -->
<details-card title="Sailor" section-id="sailor" ng-hide="hidden.abilities" ng-if="details.sailor">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.sailor">
                                    <td
                                        colspan="{{details.sailor.llbbase || details.sailor.llbcharacter1 || details.sailor.llbcharacter2 || details.sailor.llbcombined || details.sailor.llblevel1 || details.sailor.llblevel2 ? 1 : 2}}">
                                        <!-- same sailor ability -->
                                        <div ng-if="!isSailorHybrid" ng-bind-html="details.sailor | decorate"></div>
                                        <!-- different sailor abilities -->
                                        <div ng-if="isSailorHybrid">
                                            <span class="badge badge-sbase" ng-show="details.sailor.base">Base</span>
                                            <div ng-show="details.sailor.base"
                                                ng-bind-html="details.sailor.base | decorate"></div>
                                            <span class="badge badge-sbase" ng-show="details.sailor.base2">Base
                                                2</span>
                                            <div ng-show="details.sailor.base2"
                                                ng-bind-html="details.sailor.base2 | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.sailor.level1">LB Level 1</span>
                                            <div ng-show="details.sailor.level1"
                                                ng-bind-html="details.sailor.level1 | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.sailor.level2">LB Level 2</span>
                                            <div ng-show="details.sailor.level2"
                                                ng-bind-html="details.sailor.level2 | decorate"></div>
                                            <span class="badge badge-combined" ng-show="details.sailor.combined">Dual Character</span>
                                            <div ng-show="details.sailor.combined"
                                                ng-bind-html="details.sailor.combined | decorate"></div>
<div ng-if="details.sailor.character1">
                                                <div ng-if="isString(details.sailor.character1)">
                                                    <span class="badge badge-character" ng-show="details.sailor.character1">{{::char1.name}}</span>
                                                    <span ng-show="details.sailor.character1" ng-bind-html="details.sailor.character1 | decorate"></span>
                                                </div>
                                                <div ng-if="details.sailor.character1.base">
                                                    <span class="badge badge-character" ng-show="details.sailor.character1">{{::char1.name}}</span>
                                                    <span ng-show="details.sailor.character1" ng-bind-html="details.sailor.character1.base | decorate"></span>
                                                </div>
                                                <div ng-if="details.sailor.character1.base2">
                                                    <span class="badge badge-character" ng-show="details.sailor.character1">{{::char1.name}}</span>
                                                    <span ng-show="details.sailor.character1" ng-bind-html="details.sailor.character1.base2 | decorate"></span>
                                                </div>
                                            </div>
                                            <div ng-if="details.sailor.character2">
                                                <div ng-if="isString(details.sailor.character2)">
                                                    <span class="badge badge-character" ng-show="details.sailor.character2">{{::char2.name}}</span>
                                                    <span ng-show="details.sailor.character2" ng-bind-html="details.sailor.character2 | decorate"></span>
                                                </div>
                                                <div ng-if="details.sailor.character2.base">
                                                    <span class="badge badge-character" ng-show="details.sailor.character2">{{::char2.name}}</span>
                                                    <span ng-show="details.sailor.character2" ng-bind-html="details.sailor.character2.base | decorate"></span>
                                                </div>
                                                <div ng-if="details.sailor.character2.base2">
                                                    <span class="badge badge-character" ng-show="details.sailor.character2">{{::char2.name}}</span>
                                                    <span ng-show="details.sailor.character2" ng-bind-html="details.sailor.character2.base2 | decorate"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <span class="notes" ng-if="details.sailorNotes"
                                            ng-bind-html="details.sailorNotes | notes | decorate"></span>
                                    </td>
                                    <td
                                        ng-if="details.sailor.llbbase || details.sailor.llbcharacter1 || details.sailor.llbcharacter2 || details.sailor.llbcombined || details.sailor.llblevel1 || details.sailor.llblevel2">
                                        <div ng-if="isSailorHybrid">
                                            <span class="badge badge-slevel" ng-show="details.sailor.llbbase">LLB Base</span>
                                            <div ng-show="details.sailor.llbbase"
                                                ng-bind-html="details.sailor.llbbase | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.sailor.llbbase2">LLB Base
                                                Sailor 2</span>
                                            <div ng-show="details.sailor.llbbase2"
                                                ng-bind-html="details.sailor.llbbase2 | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.sailor.llblevel1">LLB LB
                                                Level 1 Sailor</span>
                                            <div ng-show="details.sailor.llblevel1"
                                                ng-bind-html="details.sailor.llblevel1 | decorate"></div>
                                            <span class="badge badge-slevel" ng-show="details.sailor.llblevel2">LLB LB
                                                Level 2 Sailor</span>
                                            <div ng-show="details.sailor.llblevel2"
                                                ng-bind-html="details.sailor.llblevel2 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.sailor.llbcharacter1">{{::char1.name}} LLB</span>
                                            <div ng-show="details.sailor.llbcharacter1"
                                                ng-bind-html="details.sailor.llbcharacter1 | decorate"></div>
                                            <span class="badge badge-character"
                                                ng-show="details.sailor.llbcharacter2">{{::char2.name}} LLB</span>
                                            <div ng-show="details.sailor.llbcharacter2"
                                                ng-bind-html="details.sailor.llbcharacter2 | decorate"></div>
                                            <span class="badge badge-combined" ng-show="details.sailor.llbcombined">LLB
                                                Dual Character</span>
                                            <div ng-show="details.sailor.llbcombined"
                                                ng-bind-html="details.sailor.llbcombined | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.sailorNotes"
                                            ng-bind-html="details.sailorNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Swap -->
<details-card title="Swap" section-id="swap" ng-hide="hidden.abilities" ng-if="details.swap">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.swap">
                                    <td>
                                        <!-- same sailor ability -->
                                        <div ng-if="!isSwapHybrid" ng-bind-html="details.swap | decorate"></div>
                                        <!-- different sailor abilities -->
                                        <div ng-if="isSwapHybrid">
                                            <span class="badge badge-swap" ng-show="details.swap.base">Base Swap</span>
                                            <div ng-show="details.swap.base"
                                                ng-bind-html="details.swap.base | decorate"></div>
                                            <span class="badge badge-superswap" ng-show="details.swap.super">Super Swap
                                                [{{::details.swap.superTurns}} Swaps]</span>
                                            <div ng-show="details.swap.super"
                                                ng-bind-html="details.swap.super | decorate"></div>
                                        </div>
                                        <span class="notes" ng-if="details.swapNotes"
                                            ng-bind-html="details.swapNotes | notes | decorate"></span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

<details-card title="Support" section-id="support" ng-hide="hidden.abilities" ng-if="details.support">

            <div class="panel panel-default">
                <table class="table table-striped-column abilities">
                    <!--------------    Support Abilities    -------------->
                    <!--------------    isSupportHybrid is not used since JPN and Global all match so far, leaving in for future cases    -------------->
                    <tbody>
                        <tr ng-if="details.support">
                            <td>
                                <div ng-if="!isSupportHybrid && isSupportStaged">
                                    <div ng-repeat="stage in details.support track by $index">
                                        <strong>Supported Characters:</strong> <span
                                            ng-bind-html="stage.Characters | decorate"></span>
                                        <div ng-repeat="item in stage.description track by $index"><strong>Level
                                                {{::$index + 1}}:</strong>
                                            <span ng-bind-html="item | decorate"></span><br>
                                        </div>
                                        <add-support-query criteria="stage.Characters"
                                            excluded-families="families"></add-support-query>
                                    </div>
                                </div>
                                <span class="notes" ng-if="details.supportNotes"
                                    ng-bind-html="details.supportNotes | notes | decorate"></span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <add-supporters-query uid="unit.id"></add-supporters-query>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </details-card>

<details-card title="Limit Break" section-id="limitBreak" ng-hide="hidden.abilities"
                ng-if="details.limit || details.potential || unit.maxLevel == 99">

            <div class="panel panel-default" ng-hide="hidden.abilities" ng-if="details.limit || details.potential">
                <table class="table table-striped-column abilities">
                    <tbody>
                        <tr ng-if="details.limit">
                            <td>
                                <!-- same limit break (differences across versions) -->
                                <div ng-if="!isLimitHybrid && !isLimitStaged" ng-bind-html="details.limit | decorate">
                                </div>
                                <!-- different limit abilities -->
                                <div ng-if="!isLimitHybrid && isLimitStaged">
                                    <div ng-repeat="stage in details.limit track by $index">
                                        <strong>Level {{::$index + 1}}:</strong>
                                        <span ng-bind-html="stage | decorate"></span>
                                    </div>
                                </div>
                                <div ng-if="isLimitHybrid">
                                </div>
                                <span class="notes" ng-if="details.limitNotes"
                                    ng-bind-html="details.limitNotes | notes | decorate"></span>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Potential Abilities -->
<details-card title="Potential Abilities" section-id="potential" ng-hide="hidden.abilities" ng-if="details.potential">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.potential">
                            <td>
                                <!-- same potential break (differences across versions) -->
                                <div ng-if="!isPotentialHybrid && !isPotentialStaged"
                                    ng-bind-html="details.potential | decorate"></div>
                                <!-- different potential abilities -->
                                <div ng-if="!isPotentialHybrid && isPotentialStaged">
                                    <div ng-repeat="stage in details.potential track by $index">
                                        <strong>{{$index + 1}}: {{stage.Name}}: </strong>
                                        <br>
                                        <div ng-repeat="item in stage.description track by $index"
                                            style="margin-left: 2em"><strong>Lv {{::$index + 1}}:</strong>
                                            <span ng-bind-html="item | decorate"></span><br>
                                        </div>
                                    </div>
                                </div>
                                <div ng-if="isPotentialHybrid">
                                </div>
                                <span class="notes" ng-if="details.potentialNotes" ng-bind-html="details.potentialNotes | notes | decorate"></span>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Last Tap -->
<details-card title="Last Tap" section-id="lastTap" ng-hide="hidden.abilities" ng-if="details.lastTap">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.lastTap">
                            <td>
                                <strong>Condition:</strong> <span ng-bind-html="details.lastTap.condition | decorate"></span>
                                        <div ng-repeat="item in details.lastTap.description track by $index"><strong>Level {{::$index + 1}}:</strong>
                                        <span ng-bind-html="item | decorate"></span><br></div>
                                <span class="notes" ng-if="details.lastTapNotes" ng-bind-html="details.lastTapNotes | notes | decorate"></span>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Super Tandem -->
<details-card title="Super Tandem" section-id="superTandem" ng-hide="hidden.abilities" ng-if="details.superTandem">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.superTandem">
                                    <td>
                                        <span ng-if="details.superTandem.condition"><strong>Condition:</strong> <span ng-bind-html="details.superTandem.condition | decorate"></span></span>
                                        <div ng-repeat="item in details.superTandem.description track by $index"><strong>Level {{::$index + 1}} (<span ng-bind-html="details.superTandem.characterCondition[$index] | decorate"></span>):</strong>
                                        <span ng-bind-html="item | decorate"></span><br></div>
                                        <span class="notes" ng-if="details.superTandemNotes" ng-bind-html="details.superTandemNotes | notes | decorate"></span>
                                <add-super-tandem-query criteria="details.superTandem.characterCondition[4]" excluded-families="families"></add-super-tandem-query>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Super Tandem Boost -->
<details-card title="Super Tandem Boost" section-id="superTandemBoost" ng-hide="hidden.abilities" ng-if="details.superTandemBoost">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.superTandemBoost">
                                    <td>
                                        <span ng-if="details.superTandemBoost.condition"><strong>Condition:</strong> <span ng-bind-html="details.superTandemBoost.condition | decorate"></span></span>
                                        <div ng-repeat="item in details.superTandemBoost.description track by $index"><strong>Level {{::$index + 1}} (<span ng-bind-html="details.superTandemBoost.characterCondition[$index] | decorate"></span>):</strong>
                                        <span ng-bind-html="item | decorate"></span><br></div>
                                        <span class="notes" ng-if="details.superTandemBoostNotes" ng-bind-html="details.superTandemBoostNotes | notes | decorate"></span>
                                <add-super-tandem-query criteria="details.superTandemBoost.characterCondition[4]" excluded-families="families"></add-super-tandem-query>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Rush -->
<details-card title="Rush" section-id="rush" ng-hide="hidden.abilities" ng-if="details.rush">

                    <div class="panel panel-default">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr ng-if="details.rush">
                                    <td border-spacing="0px">
                                        <div ng-if="details.rush.condition"><strong>Condition:</strong> <div ng-bind-html="details.rush.condition | decorate"></div></div>
                                        <table class="table table-striped-column abilities rush">
                                            <tbody>
                                                <tr ng-repeat-start="item in details.rush.description track by $index">
                                                    <th colspan="2"><strong>Level {{::$index + 1}} (<span ng-bind-html="details.rush.characterCondition[$index] | decorate"></span>)</strong></th>
                                                </tr>
                                                <tr ng-repeat-end>
                                                    <td width="50%"><!--strong>Level {{::$index + 1}} (<span ng-bind-html="details.rush.characterCondition[$index] | decorate"></span>):</strong-->
                                                    <div ng-bind-html="item | decorate"></div></td>
                                                    <td><div ng-bind-html="details.rush.stats[$index] | decorate"></div></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <span class="notes" ng-if="details.rushNotes" ng-bind-html="details.rushNotes | notes | decorate"></span>
                                <add-super-tandem-query criteria="details.rush.characterCondition[4]" excluded-families="families"></add-super-tandem-query>
                            </td>
                        </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- Level Limit Break -->
                    <details-card title="Level Limit Break" section-id="levelLimitBreak" ng-hide="hidden.abilities">

                    <div class="panel panel-default" ng-if="unit.maxLevel == 99">
                        <table class="table table-striped-column abilities">
                            <tbody>
                                <tr>
                                    <td>
                                        <div ng-repeat="stage in details.lLimit track by $index" ng-if="details.lLimit">
                                            <div><strong>Level {{::$index + 1}}:</strong> Increase Max Level to {{::[105, 110, 120, 130, 150][$index]}}</div>
                                            <span ng-if="stage.captain.base" class="badge badge-base">Base Captain</span><div ng-if="stage.captain.base" ng-bind-html="stage.captain.base | decorate"></div>
                                            <span ng-if="stage.captain.level1" class="badge badge-level1">LB Level 1 Captain</span><div ng-if="stage.captain.level1" ng-bind-html="stage.captain.level1 | decorate"></div>
                                            <span ng-if="stage.captain.level2" class="badge badge-level2">LB Level 2 Captain</span><div ng-if="stage.captain.level2" ng-bind-html="stage.captain.level2 | decorate"></div>
                                            <span ng-if="stage.captain.level6" class="badge badge-level6">LB Level 6 Captain</span><div ng-if="stage.captain.level6" ng-bind-html="stage.captain.level6 | decorate"></div>
                                            <span ng-if="stage.captain.character1" class="badge badge-character">{{::char1.name}} Captain</span><div ng-if="stage.captain.character1" ng-bind-html="stage.captain.character1 | decorate"></div>
                                            <span ng-if="stage.captain.character2" class="badge badge-character">{{::char2.name}} Captain</span><div ng-if="stage.captain.character2" ng-bind-html="stage.captain.character2 | decorate"></div>
                                            <span ng-if="stage.captain.combined" class="badge badge-combined">Dual Character Captain</span><div ng-if="stage.captain.combined" ng-bind-html="stage.captain.combined | decorate"></div>
                                            <span ng-if="stage.sailor.base" class="badge badge-sbase">Base Sailor</span><div ng-if="stage.sailor.base" ng-bind-html="stage.sailor.base | decorate"></div>
                                            <span ng-if="stage.sailor.base2" class="badge badge-sbase">Base Sailor 2</span><div ng-if="stage.sailor.base2" ng-bind-html="stage.sailor.base2 | decorate"></div>
                                            <span ng-if="stage.sailor.level1" class="badge badge-slevel">LB Level 1 Sailor</span><div ng-if="stage.sailor.level1" ng-bind-html="stage.sailor.level1 | decorate"></div>
                                            <span ng-if="stage.sailor.level2" class="badge badge-slevel">LB Level 2 Sailor</span><div ng-if="stage.sailor.level2" ng-bind-html="stage.sailor.level2 | decorate"></div>
                                            <span ng-if="stage.sailor.character1" class="badge badge-character">{{::char1.name}} Sailor</span><div ng-if="stage.sailor.character1" ng-bind-html="stage.sailor.character1 | decorate"></div>
                                            <span ng-if="stage.sailor.character2" class="badge badge-character">{{::char2.name}} Sailor</span><div ng-if="stage.sailor.character2" ng-bind-html="stage.sailor.character2 | decorate"></div>
                                            <span ng-if="stage.sailor.combined" class="badge badge-combined">Dual Character Sailor</span><div ng-if="stage.sailor.combined" ng-bind-html="stage.sailor.combined | decorate"></div>
                                            <span ng-if="stage.special.base" class="badge badge-slevel">Base Special</span><div ng-if="stage.special.base && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.base | decorate"></div>
                                            <span ng-if="stage.special.level1" class="badge badge-slevel">Level 1 Special</span><div ng-if="stage.special.level1 && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.level1 | decorate"></div>
                                            <span ng-if="stage.special.level2" class="badge badge-slevel">Level 2 Special</span><div ng-if="stage.special.level2 && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.level2 | decorate"></div>
                                            <span ng-if="stage.special.character1" class="badge badge-character">{{::char1.name}} Special</span><div ng-if="stage.special.character1 && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.character1 | decorate"></div>
                                            <span ng-if="stage.special.character2" class="badge badge-character">{{::char2.name}} Special</span><div ng-if="stage.special.character2 && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.character2 | decorate"></div>
                                            <span ng-if="stage.special.combined" class="badge badge-combined">Combined Special</span><div ng-if="stage.special.combined && !isLLBSpecialStaged[$index]" ng-bind-html="stage.special.combined | decorate"></div>
                                            <span ng-if="stage.special && isLLBSpecialStaged[$index]"><br>
                                                <div ng-repeat="stage1 in stage.special.base track by $index">
                                                    <strong>Stage {{::$index + 1}}</strong>
                                                    ({{::stage1.cooldown.length ? stage1.cooldown[0] : stage1.cooldown}}{{::stage1.cooldown.length ? ' \u2192 ' + stage1.cooldown[1] : ''}} turns) <span ng-if="unit.limitCD != 0"><strong>➤</strong>
                                                    ({{::stage1.cooldown.length ? stage1.cooldown[0] - unit.limitCD : stage1.cooldown}}{{::stage1.cooldown.length ? ' \u2192 ' + (stage1.cooldown[1] - unit.limitCD) : ''}} turns)</span><span ng-if="unit.limitexCD != 0 && unit.limitexCD != unit.limitCD"><strong>➤</strong>
                                                    ({{::stage1.cooldown.length ? stage1.cooldown[0] - unit.limitexCD : stage1.cooldown}}{{::stage1.cooldown.length ? ' \u2192 ' + (stage1.cooldown[1] - unit.limitexCD) : ''}} turns)</span>:
                                                    <span ng-bind-html="stage1.description | decorate"></span>
                                                </div>
                                            </span>
                                            <div ng-if="stage.rResilience" class="badge badge-slevel">Rumble Resilience</div><br ng-if="stage.rResilience"><div ng-if="stage.rResilience" ng-repeat="item in rumble.festResistance.llbbase"><span ng-bind-html="item | decorate"></span></div>
                                            <div ng-if="stage.rAbility" class="badge badge-slevel">Rumble Ability</div><br ng-if="stage.rAbility"><div ng-if="stage.rAbility" ng-repeat="item in rumble.festAbility.llbbase[rumble.festAbility.llbbase.length-1]"><span ng-bind-html="item | decorate"></span></div>
                                            <div ng-if="stage.rSpecial" class="badge badge-slevel">Rumble Special</div><br ng-if="stage.rSpecial"><div ng-if="stage.rSpecial" ng-repeat="item in rumble.festSpecial.llbbase.descriptions[rumble.festSpecial.llbbase.descriptions.length-1]"><span ng-bind-html="item | decorate"></span></div>
                                            <div ng-if="stage.rSuperSpecial" class="badge badge-slevel">Rumble Super Special</div><br ng-if="stage.rSuperSpecial"><div ng-if="stage.rSuperSpecial" ng-repeat="item in rumble.festSuperSpecial.llbbase.description"><span ng-bind-html="item | decorate"></span></div>
                                            <div ng-if="stage.gpAbility" class="badge badge-slevel">Grand Party Abilty</div><br ng-if="stage.gpAbility"><div ng-if="stage.gpAbility" ng-repeat="item in rumble.festGPAbility.llbbase[rumble.festGPAbility.llbbase.length-1]"><span ng-bind-html="item | decorate"></span></div>
                                            <div ng-if="stage.gpSpecial" class="badge badge-slevel">Grand Party Special</div><br ng-if="stage.gpSpecial"><div ng-if="stage.gpSpecial" ng-repeat="item in rumble.festGPSpecial.llbbase.descriptions[rumble.festGPSpecial.llbbase.descriptions.length-1]"><span ng-bind-html="item | decorate"></span></div>
                                            <br ng-if="$index != 4">
                                        </div>
                                        <div ng-repeat="x in [].constructor(5) track by $index" ng-if="!details.lLimit">
                                            <strong>Level {{::$index + 1}}:</strong> Increase Max Level to {{::[105, 110, 120, 130, 150][$index]}}
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details-card>

                    <!-- ==========================================================================
                         PIRATE RUMBLE SECTION
                         
                         Shows when:
                         - Primary: rumble object exists (from rumble.js)
                         - Fallback: !rumble AND details.js has fest* data
                         
                         Conditional content inside switches between:
                         - rumble.* (primary - more detailed data)
                         - details.* (fallback - less detailed data)
                         ========================================================================== -->
                    <details-card title="Pirate Rumble" section-id="rumble" ng-hide="hidden.abilities" 
                        ng-if="rumble || (!rumble && (details.festAttackPattern || details.festAttackTarget || details.festResistance || details.festAbility || details.festSpecial || details.festSuperSpecial))">
                        <div class="panel panel-default">
                            
                            <!-- PRIMARY: Using rumble.js data (more detailed) -->
                            <table class="table table-striped-column abilities" ng-if="rumble">
                                <tbody>
                                    <!-- Character 1 Stats Row -->
                                    <tr>
                                        <th ng-if="rumble2"><span>{{::char1.name}}</span></th>
                                        <td ng-if="!rumble2"><span>Stats</span></td>
                                        <td>
                                            <span>Class: {{::rumble.festStats.style | decorate}}</span>
                                            <span style="margin-left: 15px;">DEF: {{::rumble.festStats.def | number}}</span>
                                            <span style="margin-left: 15px;">SPD: {{::rumble.festStats.spd | number}}</span>
                                            <span style="margin-left: 15px;">Cost: {{::rumble.festCost | number}}</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Attack Pattern -->
                                    <tr ng-if="rumble.festAttackPattern">
                                        <td width="5%">Attack Pattern</td>
                                        <td colspan="2">
                                            <span ng-repeat="item in rumble.festAttackPattern track by $index">
                                                <span ng-bind-html="item | decorate"></span>{{::$index != rumble.festAttackPattern.length - 1 ? ' \u21e8 ' : ''}}
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Attack Target -->
                                    <tr ng-if="rumble.festAttackTarget">
                                        <td width="5%">Attack Target</td>
                                        <td colspan="{{hasRumbleLLB(rumble) ? 2 : 1}}">
                                            <span ng-bind-html="rumble.festAttackTarget | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- LLB Header -->
                                    <tr ng-if="hasRumbleLLB(rumble)">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Resistance -->
                                    <tr ng-if="rumble.festResistance">
                                        <td width="5%">Resistance</td>
                                        <td ng-style="!hasRumbleLLB(rumble) ? {'width': '100%'} : {}">
                                            <span ng-repeat="item in rumble.festResistance.base track by $index">
                                                <span ng-bind-html="item | decorate"></span><br>
                                            </span>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble)">
                                            <span ng-repeat="item in rumble.festResistance.llbbase track by $index">
                                                <span ng-bind-html="item | decorate"></span><br>
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Rumble Ability -->
                                    <tr ng-if="rumble.festAbility">
                                        <td width="5%">
                                            Rumble Ability
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasRumbleLLB(rumble) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festAbility.base : [rumble.festAbility.base[rumble.festAbility.base.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festAbility.base.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festAbility.llbbase : [rumble.festAbility.llbbase[rumble.festAbility.llbbase.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festAbility.llbbase.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Rumble Special -->
                                    <tr ng-if="rumble.festSpecial">
                                        <td width="5%">
                                            Rumble Special
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasRumbleLLB(rumble) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festSpecial.base.descriptions : [rumble.festSpecial.base.descriptions[rumble.festSpecial.base.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festSpecial.base.descriptions.length}}: [{{rumble.festSpecial.base.cooldown}} seconds]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festSpecial.llbbase.descriptions : [rumble.festSpecial.llbbase.descriptions[rumble.festSpecial.llbbase.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festSpecial.llbbase.descriptions.length}}: [{{rumble.festSpecial.llbbase.cooldown}} seconds]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Super Special Table (Primary) -->
                            <table class="table table-striped-column abilities" ng-if="rumble && rumble.festSuperSpecial">
                                <tbody>
                                    <tr ng-if="rumble.festSuperSpecial.llbbase">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Super Special Condition</td>
                                        <td ng-style="!rumble.festSuperSpecial.llbbase ? {'width': '100%'} : {style: 'width: 47.5%'}">
                                            <span ng-bind-html="rumble.festSuperSpecial.base.condition | decorate"></span>
                                        </td>
                                        <td ng-if="rumble.festSuperSpecial.llbbase" style="width: 50%">
                                            <span ng-bind-html="rumble.festSuperSpecial.llbbase.condition | decorate"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Rumble Super Special</td>
                                        <td ng-style="!rumble.festSuperSpecial.llbbase ? {'width': '100%'} : {style: 'width: 47.5%'}">
                                            <div ng-repeat="item in rumble.festSuperSpecial.base.description"><span ng-bind-html="item | decorate"></span></div>
                                        </td>
                                        <td ng-if="rumble.festSuperSpecial.llbbase" style="width: 50%">
                                            <div ng-repeat="item in rumble.festSuperSpecial.llbbase.description"><span ng-bind-html="item | decorate"></span></div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Character 2 Stats (Dual Unit) - Primary -->
                            <table class="table table-striped-column abilities" style="border-top: 1px solid #000" ng-if="rumble && rumble2">
                                <tbody>
                                    <tr>
                                        <th><span>{{::char2.name}}</span></th>
                                        <td>
                                            <span>Class: {{::rumble2.festStats.style | decorate}}</span>
                                            <span>DEF: {{::rumble2.festStats.def | number}}</span>
                                            <span>SPD: {{::rumble2.festStats.spd | number}}</span>
                                            <span>Cost: {{::rumble2.festCost | number}}</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 Attack Pattern -->
                                    <tr ng-if="rumble2.festAttackPattern">
                                        <td width="5%">Attack Pattern</td>
                                        <td colspan="2">
                                            <span ng-repeat="item in rumble2.festAttackPattern track by $index">
                                                <span ng-bind-html="item | decorate"></span>{{::$index != rumble2.festAttackPattern.length - 1 ? ' \u21e8 ' : ''}}
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 Attack Target -->
                                    <tr ng-if="rumble2.festAttackTarget">
                                        <td width="5%">Attack Target</td>
                                        <td colspan="{{hasRumbleLLB(rumble2) ? 2 : 1}}">
                                            <span ng-bind-html="rumble2.festAttackTarget | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 LLB Header -->
                                    <tr ng-if="hasRumbleLLB(rumble2)">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Character 2 Resistance -->
                                    <tr ng-if="rumble2.festResistance">
                                        <td width="5%">Resistance</td>
                                        <td ng-style="!hasRumbleLLB(rumble2) ? {'width': '100%'} : {}">
                                            <span ng-repeat="item in rumble2.festResistance.base track by $index">
                                                <span ng-bind-html="item | decorate"></span><br>
                                            </span>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble2)">
                                            <span ng-repeat="item in rumble2.festResistance.llbbase track by $index">
                                                <span ng-bind-html="item | decorate"></span><br>
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 Ability -->
                                    <tr ng-if="rumble2.festAbility">
                                        <td width="5%">
                                            Rumble Ability
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasRumbleLLB(rumble2) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festAbility.base : [rumble2.festAbility.base[rumble2.festAbility.base.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festAbility.base.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble2)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festAbility.llbbase : [rumble2.festAbility.llbbase[rumble2.festAbility.llbbase.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festAbility.llbbase.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 Special -->
                                    <tr ng-if="rumble2.festSpecial">
                                        <td width="5%">
                                            Rumble Special
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasRumbleLLB(rumble2) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festSpecial.base.descriptions : [rumble2.festSpecial.base.descriptions[rumble2.festSpecial.base.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festSpecial.base.descriptions.length}}: [{{rumble2.festSpecial.base.cooldown}} seconds]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasRumbleLLB(rumble2)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festSpecial.llbbase.descriptions : [rumble2.festSpecial.llbbase.descriptions[rumble2.festSpecial.llbbase.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festSpecial.llbbase.descriptions.length}}: [{{rumble2.festSpecial.llbbase.cooldown}} seconds]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Character 2 Super Special (Dual Unit) - Primary -->
                            <table class="table table-striped-column abilities" ng-if="rumble && rumble2 && rumble2.festSuperSpecial">
                                <tbody>
                                    <tr ng-if="rumble2.festSuperSpecial.llbbase">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Super Special Condition</td>
                                        <td ng-style="!rumble2.festSuperSpecial.llbbase ? {'width': '100%'} : {style: 'width: 47.5%'}">
                                            <span ng-bind-html="rumble2.festSuperSpecial.base.condition | decorate"></span>
                                        </td>
                                        <td ng-if="rumble2.festSuperSpecial.llbbase" style="width: 50%">
                                            <span ng-bind-html="rumble2.festSuperSpecial.llbbase.condition | decorate"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Rumble Super Special</td>
                                        <td ng-style="!rumble2.festSuperSpecial.llbbase ? {'width': '100%'} : {style: 'width: 47.5%'}">
                                            <div ng-repeat="item in rumble2.festSuperSpecial.base.description"><span ng-bind-html="item | decorate"></span></div>
                                        </td>
                                        <td ng-if="rumble2.festSuperSpecial.llbbase" style="width: 50%">
                                            <div ng-repeat="item in rumble2.festSuperSpecial.llbbase.description"><span ng-bind-html="item | decorate"></span></div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- ==========================================================================
                                 FALLBACK: Using details.js data (less detailed)
                                 Shows when: !rumble (rumble.js not available)
                                 ========================================================================== -->
                            <table class="table table-striped-column abilities" ng-if="!rumble && (details.festAttackPattern || details.festAttackTarget || details.festResistance || details.festAbility || details.festSpecial)">
                                <tbody>
                                    <!-- Character 1 Stats Row (Fallback) -->
                                    <tr>
                                        <th ng-if="rumble2"><span>{{::char1.name}}</span></th>
                                        <td ng-if="!rumble2"><span>Stats</span></td>
                                        <td>
                                            <span>Class: {{::rumble.festStats.style | decorate}}</span>
                                            <span style="margin-left: 15px;">DEF: {{::rumble.festStats.def | number}}</span>
                                            <span style="margin-left: 15px;">SPD: {{::rumble.festStats.spd | number}}</span>
                                            <span style="margin-left: 15px;">Cost: {{::rumble.festCost | number}}</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Character 2 Stats Row (Fallback - Dual Unit) -->
                                    <tr ng-if="rumble2">
                                        <th><span>{{::char2.name}}</span></th>
                                        <td>
                                            <span>Class: {{::rumble2.festStats.style | decorate}}</span>
                                            <span>DEF: {{::rumble2.festStats.def | number}}</span>
                                            <span>SPD: {{::rumble2.festStats.spd | number}}</span>
                                            <span>Cost: {{::rumble2.festCost | number}}</span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Attack Pattern -->
                                    <tr ng-if="details.festAttackPattern">
                                        <td width="5%">Attack Pattern</td>
                                        <td colspan="2">
                                            <div ng-repeat="item in details.festAttackPattern track by $index">
                                                <span ng-bind-html="item | decorate"></span>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Attack Target -->
                                    <tr ng-if="details.festAttackTarget">
                                        <td width="5%">Attack Target</td>
                                        <td colspan="2"><span ng-bind-html="details.festAttackTarget | decorate"></span></td>
                                    </tr>
                                    
                                    <!-- LLB Header -->
                                    <tr ng-if="details.festResistance.hasOwnProperty('base') || details.festAbility.hasOwnProperty('base') || details.festSpecial.hasOwnProperty('base')">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Resistance -->
                                    <tr ng-if="details.festResistance">
                                        <td width="5%">Resistance</td>
                                        <td ng-if="!details.festResistance.hasOwnProperty('base')">
                                            <span ng-bind-html="details.festResistance | decorate"></span>
                                        </td>
                                        <td ng-if="details.festResistance.hasOwnProperty('base')">
                                            <span ng-bind-html="details.festResistance.base | decorate"></span>
                                        </td>
                                        <td ng-if="details.festResistance.hasOwnProperty('llbbase')">
                                            <span ng-bind-html="details.festResistance.llbbase | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Rumble Ability -->
                                    <tr ng-if="details.festAbility">
                                        <td width="5%">Rumble Ability</td>
                                        <td ng-if="!details.festAbility.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbility track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbility.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbility.base track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbility.hasOwnProperty('llbbase')">
                                            <div ng-repeat="item in details.festAbility.llbbase track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item | decorate"></span><br>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Rumble Special -->
                                    <tr ng-if="details.festSpecial">
                                        <td width="5%">Rumble Special</td>
                                        <td ng-if="!details.festSpecial.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festSpecial track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.cooldown}} seconds]</strong> <span ng-bind-html="item.description | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festSpecial.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festSpecial.base track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.cooldown}} seconds]</strong> <span ng-bind-html="item.description | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festSpecial.hasOwnProperty('llbbase')">
                                            <div ng-repeat="item in details.festSpecial.llbbase track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.cooldown}} seconds]</strong> <span ng-bind-html="item.description | decorate"></span><br>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Super Special Table (Fallback) -->
                            <table class="table table-striped-column abilities" ng-if="!rumble && details.festSuperSpecial">
                                <tbody>
                                    <tr ng-if="!details.festResistance.hasOwnProperty('base') || !details.festAbility.hasOwnProperty('base') || !details.festSpecial.hasOwnProperty('base')">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Super Special Condition</td>
                                        <td style="width: 47.5%"><span ng-bind-html="details.festSuperSpecial.base.condition | decorate"></span></td>
                                        <td style="width: 50%"><span ng-bind-html="details.festSuperSpecial.llbbase.condition | decorate"></span></td>
                                    </tr>
                                    <tr>
                                        <td>Rumble Super Special</td>
                                        <td><span ng-bind-html="details.festSuperSpecial.base.description | decorate"></span></td>
                                        <td><span ng-bind-html="details.festSuperSpecial.llbbase.description | decorate"></span></td>
                                    </tr>
                                </tbody>
                            </table>
                            
                        </div>
                    </details-card>

                    <!-- ==========================================================================
                         GRAND PARTY SECTION
                         
                         Shows when:
                         - Primary: rumble.js loaded with GP data
                         - Fallback: !rumble.gp* AND details.js has GP data
                         
                         Conditional content inside switches between:
                         - rumble.* (primary - more detailed data)
                         - details.* (fallback - less detailed data)
                         ========================================================================== -->
                    <details-card title="Grand Party" section-id="grandParty" ng-hide="hidden.abilities" 
                        ng-if="rumble.festGPAbility || rumble.festGPSpecial || (!rumble.gpability && !rumble.gpcondition && !rumble.gpspecial && (details.festAbilityGP || details.festAbilityGPCondition))">
                        <div class="panel panel-default">
                            
                            <!-- PRIMARY: Using rumble.js data (more detailed) -->
                            <table class="table table-striped-column abilities" ng-if="rumble.festGPAbility || rumble.festGPSpecial">
                                <tbody>
                                    <!-- Character 1 Header -->
                                    <tr ng-if="rumble2"><th colspan="2">{{::char1.name}}</th></tr>
                                    
                                    <!-- LLB Header -->
                                    <tr ng-if="hasGrandPartyLLB(rumble)">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Leader Skill -->
                                    <tr ng-if="rumble.festGPAbility">
                                        <td width="5%">
                                            Leader Skill
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasGrandPartyLLB(rumble) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festGPAbility.base : [rumble.festGPAbility.base[rumble.festGPAbility.base.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festGPAbility.base.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasGrandPartyLLB(rumble)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festGPAbility.llbbase : [rumble.festGPAbility.llbbase[rumble.festGPAbility.llbbase.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festGPAbility.llbbase.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst Condition -->
                                    <tr ng-if="rumble.festGPSpecial">
                                        <td width="5%">Burst Condition</td>
                                        <td ng-style="!hasGrandPartyLLB(rumble) ? {'width': '100%'} : {}">
                                            <span ng-bind-html="rumble.festGPSpecial.base.condition | decorate"></span>
                                        </td>
                                        <td ng-if="rumble.festGPSpecial.llbbase.condition">
                                            <span ng-bind-html="rumble.festGPSpecial.llbbase.condition | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst -->
                                    <tr ng-if="rumble.festGPSpecial">
                                        <td width="5%">
                                            Burst
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasGrandPartyLLB(rumble) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festGPSpecial.base.descriptions : [rumble.festGPSpecial.base.descriptions[rumble.festGPSpecial.base.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festGPSpecial.base.descriptions.length}}: [{{rumble.festGPSpecial.base.uses}} use{{rumble.festGPSpecial.base.uses == 1 ? "" : "s"}}]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasGrandPartyLLB(rumble)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble.festGPSpecial.llbbase.descriptions : [rumble.festGPSpecial.llbbase.descriptions[rumble.festGPSpecial.llbbase.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble.festGPSpecial.llbbase.descriptions.length}}: [{{rumble.festGPSpecial.llbbase.uses}} use{{rumble.festGPSpecial.llbbase.uses == 1 ? "" : "s"}}]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- Character 2 (Dual Unit) - Primary -->
                            <table class="table table-striped-column abilities" ng-if="rumble2 && (rumble.festGPAbility || rumble.festGPSpecial)">
                                <tbody>
                                    <tr><th colspan="2">{{::char2.name}}</th></tr>
                                    
                                    <!-- LLB Header -->
                                    <tr ng-if="hasGrandPartyLLB(rumble2)">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Leader Skill -->
                                    <tr ng-if="rumble2.festGPAbility">
                                        <td width="5%">
                                            Leader Skill
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasGrandPartyLLB(rumble2) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festGPAbility.base : [rumble2.festGPAbility.base[rumble2.festGPAbility.base.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festGPAbility.base.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasGrandPartyLLB(rumble2)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festGPAbility.llbbase : [rumble2.festGPAbility.llbbase[rumble2.festGPAbility.llbbase.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festGPAbility.llbbase.length}}:</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst Condition -->
                                    <tr ng-if="rumble2.festGPSpecial">
                                        <td width="5%">Burst Condition</td>
                                        <td ng-style="!hasGrandPartyLLB(rumble2) ? {'width': '100%'} : {}">
                                            <span ng-bind-html="rumble2.festGPSpecial.base.condition | decorate"></span>
                                        </td>
                                        <td ng-if="rumble2.festGPSpecial.llbbase.condition">
                                            <span ng-bind-html="rumble2.festGPSpecial.llbbase.condition | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst -->
                                    <tr ng-if="rumble2.festGPSpecial">
                                        <td width="5%">
                                            Burst
                                            <label style="font-weight: normal; display: block; margin-top: 4px; font-size: 0.8em; text-align: center;">
                                                <input type="checkbox" ng-model="showAllRumbleLevels"> All Levels
                                            </label>
                                        </td>
                                        <td ng-style="!hasGrandPartyLLB(rumble2) ? {'width': '100%'} : {}">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festGPSpecial.base.descriptions : [rumble2.festGPSpecial.base.descriptions[rumble2.festGPSpecial.base.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festGPSpecial.base.descriptions.length}}: [{{rumble2.festGPSpecial.base.uses}} use{{rumble2.festGPSpecial.base.uses == 1 ? "" : "s"}}]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                        <td ng-if="hasGrandPartyLLB(rumble2)">
                                            <div ng-repeat="level in (showAllRumbleLevels ? rumble2.festGPSpecial.llbbase.descriptions : [rumble2.festGPSpecial.llbbase.descriptions[rumble2.festGPSpecial.llbbase.descriptions.length - 1]]) track by $index">
                                                <strong>Level {{showAllRumbleLevels ? $index + 1 : rumble2.festGPSpecial.llbbase.descriptions.length}}: [{{rumble2.festGPSpecial.llbbase.uses}} use{{rumble2.festGPSpecial.llbbase.uses == 1 ? "" : "s"}}]</strong>
                                                <div ng-repeat="item in level"><span ng-bind-html="item | decorate"></span></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <!-- ==========================================================================
                                 FALLBACK: Using details.js data (less detailed)
                                 Shows when: !rumble.gpability && !rumble.gpcondition && !rumble.gpspecial
                                 ========================================================================== -->
                            <table class="table table-striped-column abilities" ng-if="!rumble.gpability && !rumble.gpcondition && !rumble.gpspecial && (details.festAbilityGP || details.festAbilityGPCondition)">
                                <tbody>
                                    <!-- LLB Header -->
                                    <tr ng-if="details.festAbilityGP.hasOwnProperty('base') || details.festAbilityGPCondition.hasOwnProperty('base')">
                                        <td width="5%"></td>
                                        <td style="width: 47.5%"><strong>Base</strong></td>
                                        <td style="width: 50%"><strong>Level Limit Break</strong></td>
                                    </tr>
                                    
                                    <!-- Leader Skill -->
                                    <tr ng-if="details.festAbilityGP">
                                        <td width="5%">Leader Skill</td>
                                        <td ng-if="!details.festAbilityGP.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbilityGP track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item.festGPAbility | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbilityGP.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbilityGP.base track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item.festGPAbility | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbilityGP.hasOwnProperty('llbbase')">
                                            <div ng-repeat="item in details.festAbilityGP.llbbase track by $index">
                                                <strong>Level {{$index + 1}}:</strong> <span ng-bind-html="item.festGPAbility | decorate"></span><br>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst Condition -->
                                    <tr ng-if="details.festAbilityGPCondition">
                                        <td width="5%">Burst Condition</td>
                                        <td ng-if="!details.festAbilityGPCondition.hasOwnProperty('base')">
                                            <span ng-bind-html="details.festAbilityGPCondition | decorate"></span>
                                        </td>
                                        <td ng-if="details.festAbilityGPCondition.hasOwnProperty('base')">
                                            <span ng-bind-html="details.festAbilityGPCondition.base | decorate"></span>
                                        </td>
                                        <td ng-if="details.festAbilityGPCondition.hasOwnProperty('llbbase')">
                                            <span ng-bind-html="details.festAbilityGPCondition.llbbase | decorate"></span>
                                        </td>
                                    </tr>
                                    
                                    <!-- Burst -->
                                    <tr ng-if="details.festAbilityGP">
                                        <td width="5%">Burst</td>
                                        <td ng-if="!details.festAbilityGP.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbilityGP track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.uses}} use{{item.uses == 1 ? "" : "s"}}]</strong> <span ng-bind-html="item.festGPSpecial | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbilityGP.hasOwnProperty('base')">
                                            <div ng-repeat="item in details.festAbilityGP.base track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.uses}} use{{item.uses == 1 ? "" : "s"}}]</strong> <span ng-bind-html="item.festGPSpecial | decorate"></span><br>
                                            </div>
                                        </td>
                                        <td ng-if="details.festAbilityGP.hasOwnProperty('llbbase')">
                                            <div ng-repeat="item in details.festAbilityGP.llbbase track by $index">
                                                <strong>Level {{$index + 1}}: [{{item.uses}} use{{item.uses == 1 ? "" : "s"}}]</strong> <span ng-bind-html="item.festGPSpecial | decorate"></span><br>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                        </div>
                    </details-card>

<!-- Evolutions -->
<details-card title="Evolutions" section-id="evolution" ng-if="evolution.evolution || evolvesFrom.length > 0" ng-hide="hidden.evolution">

<table class="table table-striped table-centered table-bordered table-textless"
    ng-if="evolution.evolution && !evolution.evolution.length">
    <tbody>
        <tr>
            <td>
                <evolution unit="unit" evolvers="evolution.evolvers" evolution="evolution.evolution" size="medium">
                </evolution>
            </td>
        </tr>
    </tbody>
</table>

<table class="table table-striped table-centered table-bordered table-textless"
    ng-if="evolution.evolution && evolution.evolution.length">
    <tbody>
        <tr ng-repeat="evolverSet in evolution.evolvers">
            <td>
                <evolution unit="unit" evolvers="evolverSet" evolution="evolution.evolution[$index]" size="medium">
                </evolution>
            </td>
        </tr>
    </tbody>
</table>
<!-- Evolves from -->
<table class="table table-striped table-centered table-bordered table-textless" ng-if="evolvesFrom.length > 0">
    <tbody>
        <tr ng-repeat="data in evolvesFrom">
            <td>
                <evolution unit="unit" base="data.from" evolvers="data.via" evolution="data.to" size="medium">
                </evolution>
            </td>
        </tr>
    </tbody>
</table>
</details-card>

<!-- Used by -->
<details-card title="Evolutions Requiring This Unit" section-id="usedBy" ng-if="sizeOf(usedBy) > 0" ng-hide="hidden.required">

<table ng-if="sizeOf(usedBy) > 0" class="table table-striped table-centered table-bordered table-textless">
    <tbody>
        <tr ng-if="collapsed.used && sizeOf(usedBy) > 3">
            <td><button class="btn btn-info collapse-button" ng-click="collapsed.used = false">Click to show</button>
            </td>
        </tr>
        <tr ng-repeat="(base,evolutions) in usedBy" ng-if="!collapsed.used || sizeOf(usedBy) < 4">
            <td>
                <div ng-repeat="data in evolutions track by $index">
                    <evolution unit="unit" base="base" evolvers="data.evolvers" evolution="data.evolution"
                        size="medium"></evolution>
                </div>
            </td>
        </tr>
    </tbody>
</table>
</details-card>

<!-- Drops -->
<details-card title="Drop Locations" section-id="drops" ng-if="drops.length > 0">

<span ng-show="!collapsed.drops" class="drop-warning">
    <strong>Note:</strong>
    If a drop appears in almost all of the stages of a story-mode island, it is likely to be part of the
    island's secret round. Secret rounds have an estimated 5% chance of appearing.
</span>

<table ng-if="collapsed.drops && drops.length > 3"
    class="table table-striped table-centered table-bordered table-textless">
    <tbody>
        <tr ng-if="collapsed.drops && drops.length > 3">
            <td><button class="btn btn-info collapse-button" ng-click="collapsed.drops = false">Click to show</button>
            </td>
        </tr>
    </tbody>
</table>

<div ng-if="drops.length > 0" class="panel panel-default panel-x-scroll">
    <table class="table table-striped drop-table">
        <thead ng-show="!collapsed.drops || drops.length < 4">
            <tr>
                <th>Location</th>
                <th>Chapter/Difficulty</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-if="!collapsed.drops || drops.length < 4" ng-repeat="drop in drops">
                <td>
                    <div class="slot small" decorate-slot uid="drop.thumb"></div>
                    <a href="{{::'../drops/?'+drop.name}}" target="_blank">{{::drop.name}}</a>
                    <span ng-repeat="bonus in drop.bonuses"
                        class="bonus {{::bonus.slice(0,2)}} {{::bonus.slice(3)}}"></span>
                </td>
                <td>{{::drop.data.join(', ')}}</td>
            </tr>
        </tbody>
    </table>
</div>
</details-card>

<!-- Manuals -->
<details-card title="Manual Locations" section-id="manuals" ng-if="manuals.length > 0">

<table ng-if="collapsed.manuals && manuals.length > 3"
    class="table table-striped table-centered table-bordered table-textless">
    <tbody>
        <tr ng-if="collapsed.manuals && manuals.length > 3">
            <td><button class="btn btn-info collapse-button" ng-click="collapsed.manuals = false">Click to show</button>
            </td>
        </tr>
    </tbody>
</table>

<div ng-if="manuals.length > 0" class="panel panel-default panel-x-scroll">
    <table class="table table-striped drop-table">
        <thead ng-show="!collapsed.manuals || manuals.length < 4">
            <tr>
                <th>Location</th>
                <th>Stage/Difficulty</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-if="!collapsed.manuals || manuals.length < 4" ng-repeat="drop in manuals">
                <td>
                    <div class="slot small" decorate-slot uid="drop.thumb"></div>
                    <a href="{{::'../drops/?'+drop.name}}" target="_blank">{{::drop.name}}</a>
                </td>
                <td>{{::drop.data.join(', ')}}</td>
            </tr>
        </tbody>
    </table>
</div>
</details-card>

<!-- Family -->
<details-card title="Family: {{::displayFamily}}" section-id="family" ng-if="displayFamily">

<table ng-if="collapsed.families && farmableVersions.length > 3"
    class="table table-striped table-centered table-bordered table-textless">
    <tbody>
        <tr ng-if="collapsed.families && farmableVersions.length > 3">
            <td><button class="btn btn-info collapse-button" ng-click="collapsed.families = false">Click to show
                    farmable versions</button></td>
        </tr>
    </tbody>
</table>

<div ng-if="farmableVersions.length > 0" class="panel panel-default panel-x-scroll">
    <table class="table table-striped drop-table">
        <thead ng-show="!collapsed.families || farmableVersions.length < 4">
            <tr>
                <th>Variant</th>
                <th>Farm Location</th>
                <th>Chapter/Difficulty</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-if="!collapsed.families || farmableVersions.length < 4" ng-repeat="data in farmableVersions">
                <td>
                    <div class="slot small" decorate-slot uid="data.uid"></div>
                    <a ui-sref="main.search.view({ id: data.uid, previous: getPrevious() })">{{::data.name}}</a>
                </td>
                <td><a href="{{::'../drops/?'+data.location.name}}" target="_blank">{{::data.location.name}}</a></td>
                <td>{{::data.location.data.join(', ')}}</td>
            </tr>
        </tbody>
    </table>
</div>
</details-card>

<!-- Other Names
<h3 class="page-header">Other Names</h3>
<add-names></add-names> -->

<!-- Tags -->
<details-card title="Tags" section-id="tags">

<div style="padding: 10px;">
    <add-tags></add-tags>
</div>
</details-card>
</div>
</div>

<div class="quick-nav">
    <button class="btn nav-top" title="Back to Top" scroll-to-section="modal-body-top">
    <i class="fa fa-arrow-up"></i>
    </button>
    <div class="nav-divider"></div>
    
    <button class="btn nav-info" title="Details" scroll-to-section="card-details">
    DET
    </button>
    <button class="btn nav-stats" title="Stats" scroll-to-section="card-stats" ng-hide="hidden.stats">
    STATS
    </button>
    
    <div class="nav-divider"></div>
    <button class="btn nav-skills" title="Captain" scroll-to-section="card-captain" ng-hide="hidden.abilities" ng-if="details.captain">
    CPT
    </button>
    <button class="btn nav-skills" title="Special" scroll-to-section="card-special" ng-hide="hidden.abilities" ng-if="details.special">
    SP
    </button>
    <button class="btn nav-skills" title="Super Special" scroll-to-section="card-superSpecial" ng-hide="hidden.abilities" ng-if="details.superSpecial">
    SSP
    </button>
    <button class="btn nav-skills" title="VS Special" scroll-to-section="card-vsSpecial" ng-hide="hidden.abilities" ng-if="details.VSSpecial">
    VS
    </button>
    <button class="btn nav-skills" title="Sailor" scroll-to-section="card-sailor" ng-hide="hidden.abilities" ng-if="details.sailor">
    SAIL
    </button>
    <button class="btn nav-skills" title="Swap" scroll-to-section="card-swap" ng-hide="hidden.abilities" ng-if="details.swap">
    SWAP
    </button>
    <button class="btn nav-skills" title="Support" scroll-to-section="card-support" ng-hide="hidden.abilities" ng-if="details.support">
    SUP
    </button>
    
    <div class="nav-divider"></div>
    <button class="btn nav-meta" title="Limit Break" scroll-to-section="card-limitBreak" ng-hide="hidden.abilities" ng-if="details.limit || details.potential || unit.maxLevel == 99">
    LB
    </button>
    <button class="btn nav-meta" title="Potential Abilities" scroll-to-section="card-potential" ng-hide="hidden.abilities" ng-if="details.potential">
    POT
    </button>
    <button class="btn nav-meta" title="Last Tap" scroll-to-section="card-lastTap" ng-hide="hidden.abilities" ng-if="details.lastTap">
    LTAP
    </button>
    <button class="btn nav-meta" title="Super Tandem" scroll-to-section="card-superTandem" ng-hide="hidden.abilities" ng-if="details.superTandem">
    STND
    </button>
    <button class="btn nav-meta" title="Super Tandem Boost" scroll-to-section="card-superTandemBoost" ng-hide="hidden.abilities" ng-if="details.superTandemBoost">
    STNDB
    </button>
    <button class="btn nav-meta" title="Rush" scroll-to-section="card-rush" ng-hide="hidden.abilities" ng-if="details.rush">
    RUSH
    </button>
    <button class="btn nav-meta" title="Level Limit Break" scroll-to-section="card-levelLimitBreak" ng-hide="hidden.abilities">
    LLB
    </button>
    
    <div class="nav-divider"></div>
    <button class="btn nav-pvp" title="Pirate Rumble" scroll-to-section="card-rumble" ng-hide="hidden.abilities" ng-if="rumble || (!rumble && (details.festAttackPattern || details.festAttackTarget || details.festResistance || details.festAbility || details.festSpecial || details.festSuperSpecial))">
    PVP
    </button>
    <button class="btn nav-pvp" title="Grand Party" scroll-to-section="card-grandParty" ng-hide="hidden.abilities" ng-if="rumble.festGPAbility || rumble.festGPSpecial || (!rumble.gpability && !rumble.gpcondition && !rumble.gpspecial && (details.festAbilityGP || details.festAbilityGPCondition))">
    GP
    </button>
    
    <div class="nav-divider"></div>
    <button class="btn nav-evo" title="Evolutions" scroll-to-section="card-evolution" ng-if="evolution.evolution || evolvesFrom.length > 0" ng-hide="hidden.evolution">
    EVO
    </button>
    <button class="btn nav-evo" title="Used By" scroll-to-section="card-usedBy" ng-if="sizeOf(usedBy) > 0" ng-hide="hidden.required">
    UBY
    </button>
    
    <div class="nav-divider"></div>
    <button class="btn nav-info" title="Drop Locations" scroll-to-section="card-drops" ng-if="drops.length > 0">
    DRP
    </button>
    <button class="btn nav-info" title="Manual Locations" scroll-to-section="card-manuals" ng-if="manuals.length > 0">
    MAN
    </button>
    <button class="btn nav-info" title="Family" scroll-to-section="card-family" ng-if="displayFamily">
    FAM
    </button>
    <button class="btn nav-info" title="Tags" scroll-to-section="card-tags">
    TAG
    </button>
</div>

</div>

</div>
</div>

</div>
</div>